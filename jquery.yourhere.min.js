(function(a){a.yourhere={init:function(b,c){var d=parseFloat(c.css("fontSize"));var e=c.css("z-index")!="auto"?parseInt(c.css("z-index")):10;if(c.css("position")=="static")c.css("position","relative");a.yourhere.opts=a.extend({},a.fn.yourhere.defaults,b);c.children().css({zIndex:e+2,position:"relative"});a('<div class="yourhere-marker"></div>').hide().appendTo(c).css({position:"absolute",zIndex:e+3,width:a.yourhere.opts.markerWidth,cursor:"pointer",background:a.yourhere.opts.markerBackground,height:d+"px"});a('<div class="yourhere-markerline"></div>').hide().appendTo(c).css({position:"absolute",zIndex:e+1,backgroundColor:a.yourhere.opts.markerLineBackground,opacity:a.yourhere.opts.markerBackgroundOpacity,height:d+"px"});a.yourhere.checkStorage(c);a.yourhere.tempMarker(c,d,e);a.yourhere.eventsHandler(c,d)},eventsHandler:function(b,c){function e(c,e){var f=parseFloat(c.css("lineHeight"))>parseFloat(c.css("fontSize"))?parseFloat(c.css("lineHeight")):parseFloat(c.css("fontSize"));var g=c.offset().top;var h=e.pageY-g;var e=Math.floor(h/f);var i=g-d+e*f;a.yourhere.markerCreator(b,i,f);if(localStorage&&a.yourhere.opts.useLocalStorage){localStorage.removeItem("yourhere_"+window.location.href);localStorage.setItem("yourhere_"+window.location.href,i+","+f)}}var d=b.offset().top;b.hover(function(){b.find(".yourhere-temp-marker").stop(true,true).fadeIn("slow")},function(){b.find(".yourhere-temp-marker").stop(true,true).fadeOut("slow")});b.children(a.yourhere.opts.supportedElements).click(function(c){if(localStorage&&!localStorage.getItem("yourhere_first_time")&&a.yourhere.opts.firstTimeWizard){e(a(this),c);a.yourhere.firstTime(b);b.children(a.yourhere.opts.supportedElements).unbind("click")}});b.children(a.yourhere.opts.supportedElements).dblclick(function(c){e(a(this),c);if(localStorage&&!localStorage.getItem("yourhere_first_time")&&a.yourhere.opts.firstTimeWizard)a.yourhere.firstTime(b)});b.children().mousemove(function(c){var e=parseFloat(a(this).css("lineHeight"))>parseFloat(a(this).css("fontSize"))?parseFloat(a(this).css("lineHeight")):parseFloat(a(this).css("fontSize"));var f=c.pageY-d-e/2;if(c.pageY<d+e/2||c.pageY>b.height()+d)return;b.find(".yourhere-temp-marker").stop(true,true).animate({top:f,height:e+"px"},"fast")});b.find(".yourhere-marker").dblclick(function(){a(this).fadeOut("fast");b.find(".yourhere-markerline").fadeOut("fast");if(localStorage&&a.yourhere.opts.useLocalStorage)localStorage.removeItem("yourhere_"+window.location.href)})},tempMarker:function(b,c,d){a('<div class="yourhere-temp-marker"></div>').appendTo(b).css({position:"absolute",zIndex:d+1,width:a.yourhere.opts.markerWidth,height:c+"px",top:0,background:a.yourhere.opts.tempMarkerBackground});b.find(".yourhere-temp-marker").css(a.yourhere.opts.markerDirection,-b.find(".yourhere-temp-marker").width()+"px").hide()},markerCreator:function(b,c,d){b.find(".yourhere-marker, .yourhere-markerline").fadeOut("fast");b.find(".yourhere-marker").stop(true,true).fadeIn().css({height:d+"px",top:c});b.find(".yourhere-markerline").stop(true,true).fadeIn().width(b.outerWidth()+b.find(".yourhere-marker").width()).css({height:d+"px",top:c});b.find(".yourhere-marker, .yourhere-markerline").css(a.yourhere.opts.markerDirection,-b.find(".yourhere-marker").width()+"px")},checkStorage:function(b){if(localStorage&&a.yourhere.opts.useLocalStorage){var c=localStorage.getItem("yourhere_"+window.location.href);if(c&&c!=""){var d=c.split(",");a.yourhere.markerCreator(b,parseInt(d[0]),parseInt(d[1]));if(a.yourhere.opts.autoScrollToMarker){setTimeout(function(){a("body").animate({scrollTop:parseInt(d[0])})},1500)}}}else{if(localStorage)localStorage.removeItem("yourhere_"+window.location.href);return}},firstTime:function(b){if(b.find(".yourhere-tooltip").length<=0){a('<div class="yourhere-tooltip"><div class="yourhere-tooltip-step"></div></div>').appendTo(b).hide().css({width:"220px",height:"100px",padding:"10px",background:"#eee",position:"absolute",top:"0",border:"1px solid #c7c7c7",borderRadius:"5px",boxShadow:"0 1px 2px rgba(0,0,0,0.4), inset 0 0 1px #fff",lineHeight:"18px",fontSize:"12px",direction:"ltr",zIndex:"999"});var c=b.find(".yourhere-tooltip");c.css(a.yourhere.opts.markerDirection,-(parseFloat(c.outerWidth())/2)+"px").find(".yourhere-tooltip-step").html(a.yourhere.firstTimeSteps[0]);a('<div class="yourhere-tooltip-cornerT"></div>').appendTo(c).css({width:0,height:0,borderTop:"9px solid #eee",borderRight:"10px solid transparent",borderLeft:"10px solid transparent",position:"absolute",bottom:"-9px",left:parseFloat(c.width())/2-5+"px",color:"#909090",zIndex:"999"});a('<div class="yourhere-tooltip-cornerB"></div>').appendTo(c).css({width:0,height:0,borderTop:"10px solid #c7c7c7",borderRight:"11px solid transparent",borderLeft:"11px solid transparent",position:"absolute",bottom:"-10px",left:parseFloat(c.find(".yourhere-tooltip-cornerT").css("left"))-1+"px",zIndex:"998"});a('<span class="yourhere-tooltip-close">x</span>').appendTo(c).css({position:"absolute",top:"0",right:"5px",fontSize:"12px",color:"#a7a7a7",cursor:"pointer",zIndex:"1000"});a('<a class="yourhere-tooltip-next" href="#">next</a>').appendTo(c).css({position:"absolute",right:"10px",bottom:"5px"})}setTimeout(function(){a(".yourhere-tooltip").fadeIn(function(){a(".yourhere-tooltip").animate({top:parseFloat(b.find(".yourhere-marker").css("top"))-parseFloat(a(".yourhere-tooltip").outerHeight())-13});a.yourhere.checkOffset()})},1e3);a.yourhere.firstTimeTutorialEvents(b,c)},checkOffset:function(){var b=a(".yourhere-tooltip");if(b.offset().left<0){b.stop().animate({left:0+"px"})}else{b.stop().animate({left:-(parseFloat(b.outerWidth())/2)+"px"})}},firstTimeTutorialEvents:function(b,c){var d=0;c.find(".yourhere-tooltip-close").live("click",function(b){b.preventDefault();c.fadeOut("normal",function(){a(this).remove()});if(localStorage)localStorage.setItem("yourhere_first_time",false)});c.find(".yourhere-tooltip-next").live("click",function(b){b.preventDefault();d++;c.find(".yourhere-tooltip-step").fadeOut("fast",function(){a(this).html(a.yourhere.firstTimeSteps[d]).fadeIn("slow")});if(d==a.yourhere.firstTimeSteps.length-1){var e=a(this);e.removeClass("yourhere-tooltip-next").text("close");setTimeout(function(){e.addClass("yourhere-tooltip-close")},500)}});a(window).resize(function(){a.yourhere.checkOffset()})},firstTimeSteps:['<strong>Hey you</strong>! <br />We have noticed that this is the first time your\'re using "<a href="http://yourhere.gandtblog.com" target="_blank">youRhere</a>" marker in this website, so we made just for you a short "how to?" tutorial.',"<strong>youRhere</strong> allow you to mark a line on the page by just <strong>double clicking it</strong>, so you could save your reading progress and come back to it later. <br />Don't be shy, try it now!","If you accidently marked a line and you want to remove the highlight from the page your'e reading, you may do so by just <strong>double click on the marker itself</strong>.",'That\'s it! <br /> This is all you have to know about <strong>youRhere</strong>. For more information you can visit <a href="http://yourhere.gandtblog.com" target="_blank">youRhere official website</a>. <br />Enjoy!'],opts:{}};a.fn.yourhere=function(b){var c=new a.yourhere.init(b,this)};a.fn.yourhere.defaults={firstTimeWizard:true,useLocalStorage:true,autoScrollToMarker:true,markerDirection:"left",tempMarkerBackground:"#b7b7b7",markerLineBackground:"#FFF82A",markerBackgroundOpacity:"0.7",markerBackground:"#000",markerWidth:"5px",supportedElements:"h1, h2, h3, h4, h5, h6, p, ul, li"}})(jQuery)